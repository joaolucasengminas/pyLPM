

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>gslib &mdash; pyLPM 1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/my_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> pyLPM
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gslib.html">GSLib algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gslib.html#cell-declustering">Cell declustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gslib.html#kriging">Kriging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../geostatalgo.html">Geostat algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../geostatalgo.html#nearest-neighbor-estimation">Nearest neighbor estimation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utils.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../utils.html#auto-grid-creation">Auto grid creation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plots.html">Plots</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../plots.html#histogram">Histogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plots.html#scatterplot">Scatterplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plots.html#qq-plot">QQ plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plots.html#locmap">Locmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plots.html#pixel-plot">Pixel plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plots.html#swath-plots">Swath plots</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../demo wl.html">Walker lake Demo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../demo wl.html#Importing-data">Importing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demo wl.html#Plotting-locations-maps">Plotting locations maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demo wl.html#Plotting-histograms">Plotting histograms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demo wl.html#Plotting-a-scatterplot">Plotting a scatterplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demo wl.html#Plotting-a-qq-plot">Plotting a qq plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demo wl.html#Running-declus-from-GSLib">Running declus from GSLib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demo wl.html#Creating-a-grid">Creating a grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demo wl.html#Running-NN-from-Geostat-algorithms-module">Running NN from Geostat algorithms module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demo wl.html#Plotting-the-declustered-histograms">Plotting the declustered histograms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demo wl.html#Creating-another-grid">Creating another grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demo wl.html#Variography">Variography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demo wl.html#Cross-validation">Cross validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demo wl.html#Kriging">Kriging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demo wl.html#Plotting-the-estimad-grades">Plotting the estimad grades</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demo wl.html#Validating-the-model">Validating the model</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pyLPM</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>gslib</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for gslib</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pyLPM</span> <span class="k">import</span> <span class="n">plots</span>

<span class="c1">#############################################################################################################</span>

<span class="k">def</span> <span class="nf">call_program</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">parfile</span><span class="p">,</span> <span class="n">usewine</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Run a GSLib program</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        program (str): gslib program path</span>
<span class="sd">        parfile (str): parameter file file path</span>
<span class="sd">        usewine (bool, optional): use wine flag. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">usewine</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;wine&#39;</span><span class="p">,</span> <span class="n">program</span><span class="p">,</span> <span class="n">parfile</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
         <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="n">program</span><span class="p">,</span> <span class="n">parfile</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>    
        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">write_GeoEAS</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">dh</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="nb">vars</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;Write GeoEAS file from a DataFrame</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        df (DataFrame): data DataFrame</span>
<span class="sd">        dh (str): dh column name</span>
<span class="sd">        x (str): x column name</span>
<span class="sd">        y (str): y column name</span>
<span class="sd">        z (str): z column name</span>
<span class="sd">        vars (list, optional): list of string with variables names. Defaults to [].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">),</span><span class="o">-</span><span class="mi">999</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">dh</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dh</span><span class="p">)</span>
    <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">z</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">data</span><span class="o">=</span> <span class="n">data</span> <span class="o">+</span><span class="s1">&#39;tmp_pygslib_file</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">data</span><span class="o">=</span> <span class="n">data</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span> <span class="o">+</span> <span class="n">col</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">data</span><span class="o">=</span> <span class="n">data</span> <span class="o">+</span> <span class="n">values</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;pyLPM/gslib90/tmp/tmp.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">read_GeoEAS</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Read GeoEAS file into a DataFrame</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        file (str): file path</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame: DataFrame with data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">col_names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    	<span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    		<span class="k">continue</span>
    	<span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    		<span class="n">n_cols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
    	<span class="k">elif</span> <span class="n">index</span> <span class="o">&lt;=</span> <span class="n">n_cols</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
    		<span class="n">col_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    	<span class="k">else</span><span class="p">:</span>
    		<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
    		<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">col_names</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">col_number</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the column number from ist name on a GeoEAS file</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        file (str): file path</span>
<span class="sd">        col (str): column name</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        int: column number</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">col_names</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    	<span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    		<span class="k">continue</span>
    	<span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    		<span class="n">n_cols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    	<span class="k">elif</span> <span class="n">index</span> <span class="o">&lt;=</span> <span class="n">n_cols</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
    		<span class="n">col_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">col_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">write_varg_str</span><span class="p">(</span><span class="n">varg</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;nugget&#39;</span> <span class="ow">in</span> <span class="n">varg</span><span class="p">:</span>
        <span class="n">nst</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">varg</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">nugget</span> <span class="o">=</span> <span class="n">varg</span><span class="p">[</span><span class="s1">&#39;nugget&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nst</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">varg</span><span class="p">)</span>
        <span class="n">nugget</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="n">var_str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nst</span><span class="p">,</span> <span class="n">nugget</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">struct</span> <span class="ow">in</span> <span class="n">varg</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">struct</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;nugget&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">struct</span> <span class="ow">is</span> <span class="s1">&#39;spherical&#39;</span><span class="p">:</span>
                <span class="n">it</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">struct</span> <span class="ow">is</span> <span class="s1">&#39;exponetial&#39;</span><span class="p">:</span>
                <span class="n">it</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">struct</span> <span class="ow">is</span> <span class="s1">&#39;gaussian&#39;</span><span class="p">:</span>
                <span class="n">it</span> <span class="o">=</span> <span class="mi">3</span>

            <span class="n">new_lines</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">varg</span><span class="p">[</span><span class="n">struct</span><span class="p">][</span><span class="s1">&#39;cc&#39;</span><span class="p">],</span> <span class="n">varg</span><span class="p">[</span><span class="n">struct</span><span class="p">][</span><span class="s1">&#39;a1&#39;</span><span class="p">],</span> <span class="n">varg</span><span class="p">[</span><span class="n">struct</span><span class="p">][</span><span class="s1">&#39;a2&#39;</span><span class="p">],</span> <span class="n">varg</span><span class="p">[</span><span class="n">struct</span><span class="p">][</span><span class="s1">&#39;a3&#39;</span><span class="p">],</span> <span class="n">varg</span><span class="p">[</span><span class="n">struct</span><span class="p">][</span><span class="s1">&#39;r1&#39;</span><span class="p">],</span> <span class="n">varg</span><span class="p">[</span><span class="n">struct</span><span class="p">][</span><span class="s1">&#39;r2&#39;</span><span class="p">],</span> <span class="n">varg</span><span class="p">[</span><span class="n">struct</span><span class="p">][</span><span class="s1">&#39;r3&#39;</span><span class="p">])</span>

            <span class="n">var_str</span> <span class="o">=</span> <span class="n">var_str</span> <span class="o">+</span> <span class="n">new_lines</span>
        
    <span class="k">return</span> <span class="n">var_str</span>

<span class="c1">#############################################################################################################</span>

<div class="viewcode-block" id="declus"><a class="viewcode-back" href="../gslib.html#gslib.declus">[docs]</a><span class="k">def</span> <span class="nf">declus</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=-</span><span class="mf">1.0e21</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">1.0e21</span><span class="p">,</span> <span class="n">summary_file</span><span class="o">=</span><span class="s1">&#39;pyLPM/gslib90/tmp/tmpsum.dat&#39;</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;pyLPM/gslib90/tmp/tmpfile.dat&#39;</span><span class="p">,</span> <span class="n">x_anis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">z_anis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_cell</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">keep_min</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">number_offsets</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">usewine</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;cell declustering algortihm. This function shows the declustering reults summary and writes weights to the DataFrame.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        df (DataFrame): points data DataFrame</span>
<span class="sd">        x (str): x coordinates column name</span>
<span class="sd">        y (str): y coordinates column name</span>
<span class="sd">        z (str): z coordinates column name</span>
<span class="sd">        var (str): variable column name</span>
<span class="sd">        tmin (float, optional): minimum triming limit. Defaults to -1.0e21.</span>
<span class="sd">        tmax (float, optional): maximum triming limit. Defaults to 1.0e21.</span>
<span class="sd">        summary_file (str, optional): output summary file path. Defaults to &#39;pyLPM/gslib90/tmp/tmpsum.dat&#39;.</span>
<span class="sd">        output_file (str, optional): output file path. Defaults to &#39;pyLPM/gslib90/tmp/tmpfile.dat&#39;.</span>
<span class="sd">        x_anis (float, optional):  the anisotropy factors to consider rectangular cells. The cell size in the x direction is multiplied by these factors to get the cell size in the y and z directions, e.g., if a cell size of 10 is being considered and anisy2 and anisz3 then the cell size in the y direction is 20 and the cell size in the z direction is 30.. Defaults to 1.</span>
<span class="sd">        z_anis (float, optional): anisotropy factor. Defaults to 1.</span>
<span class="sd">        n_cell (int, optional): number of cells. Defaults to 10.</span>
<span class="sd">        min_size (float, optional): minimum size. Defaults to 1.</span>
<span class="sd">        max_size (float, optional): maximum size. Defaults to 20.</span>
<span class="sd">        keep_min (bool, optional): an boolean flag that specifies whether a minimum mean value (True) or maximum mean value (False) is being looked for. Defaults to True.</span>
<span class="sd">        number_offsets (int, optional): the number of origin offsets. Each of the ncell cell sizes are considered with noff different original starting points. This avoids erratic results caused by extreme values falling into specific cells. A good number is 4 in 2-D and 8 in 3-D. A short description of the program. Defaults to 4.</span>
<span class="sd">        usewine (bool, optional): use wine flag. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">write_GeoEAS</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="n">dh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span><span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>
    
    <span class="n">decluspar</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">                    Parameters for CELLDECLUS</span>
<span class="s1">                                  Parameters for DECLUS</span>
<span class="s1">                  *********************</span>

<span class="s1">START OF PARAMETERS:</span>
<span class="si">{datafile}</span><span class="s1">         -file with data</span>
<span class="si">{x}</span><span class="s1">   </span><span class="si">{y}</span><span class="s1">   </span><span class="si">{z}</span><span class="s1">   </span><span class="si">{var}</span><span class="s1">               -  columns for X, Y, Z, and variable</span>
<span class="si">{tmin}</span><span class="s1">     </span><span class="si">{tmax}</span><span class="s1">          -  trimming limits</span>
<span class="si">{sum}</span><span class="s1">                  -file for summary output</span>
<span class="si">{out}</span><span class="s1">                  -file for output with data &amp; weights</span>
<span class="si">{xanis}</span><span class="s1">   </span><span class="si">{zanis}</span><span class="s1">                   -Y and Z cell anisotropy (Ysize=size*Yanis)</span>
<span class="si">{kmin}</span><span class="s1">                           -0=look for minimum declustered mean (1=max)</span>
<span class="si">{ncell}</span><span class="s1">  </span><span class="si">{min}</span><span class="s1">  </span><span class="si">{max}</span><span class="s1">               -number of cell sizes, min size, max size</span>
<span class="si">{noff}</span><span class="s1">                           -number of origin offsets</span>
<span class="s1">&#39;&#39;&#39;</span>
    <span class="n">map_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;datafile&#39;</span><span class="p">:</span><span class="s1">&#39;pyLPM/gslib90/tmp/tmp.dat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">col_number</span><span class="p">(</span><span class="s1">&#39;pyLPM/gslib90/tmp/tmp.dat&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="n">col_number</span><span class="p">(</span><span class="s1">&#39;pyLPM/gslib90/tmp/tmp.dat&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
        <span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="n">col_number</span><span class="p">(</span><span class="s1">&#39;pyLPM/gslib90/tmp/tmp.dat&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span>
        <span class="s1">&#39;var&#39;</span><span class="p">:</span><span class="n">col_number</span><span class="p">(</span><span class="s1">&#39;pyLPM/gslib90/tmp/tmp.dat&#39;</span><span class="p">,</span> <span class="n">var</span><span class="p">),</span>
        <span class="s1">&#39;tmin&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="n">tmin</span><span class="p">),</span>
        <span class="s1">&#39;tmax&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="n">tmax</span><span class="p">),</span>
        <span class="s1">&#39;sum&#39;</span><span class="p">:</span><span class="n">summary_file</span><span class="p">,</span>
        <span class="s1">&#39;out&#39;</span><span class="p">:</span><span class="n">output_file</span><span class="p">,</span>
        <span class="s1">&#39;xanis&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="n">x_anis</span><span class="p">),</span>
        <span class="s1">&#39;zanis&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="n">z_anis</span><span class="p">),</span>
        <span class="s1">&#39;ncell&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="n">n_cell</span><span class="p">),</span>
        <span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="n">min_size</span><span class="p">),</span>
        <span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="n">max_size</span><span class="p">),</span>
        <span class="s1">&#39;kmin&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">keep_min</span> <span class="o">==</span> <span class="kc">True</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;noff&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="n">number_offsets</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">formatted_str</span> <span class="o">=</span> <span class="n">decluspar</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">map_dict</span><span class="p">)</span>
    <span class="n">parfile</span> <span class="o">=</span> <span class="s1">&#39;pyLPM/gslib90/tmp/partmp.par&#39;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">parfile</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">formatted_str</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;pyLPM/gslib90/declus.exe&quot;</span>

    <span class="n">call_program</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">parfile</span><span class="p">,</span> <span class="n">usewine</span><span class="p">)</span>

    <span class="n">df1</span> <span class="o">=</span> <span class="n">read_GeoEAS</span><span class="p">(</span><span class="n">summary_file</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">cell_declus_sum</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Cell Size&#39;</span><span class="p">],</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Declustered Mean&#39;</span><span class="p">])</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">read_GeoEAS</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Declustering Weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Declustering Weight&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="kt3d"><a class="viewcode-back" href="../gslib.html#gslib.kt3d">[docs]</a><span class="k">def</span> <span class="nf">kt3d</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">variogram</span><span class="p">,</span> <span class="n">min_samples</span><span class="p">,</span> <span class="n">max_samples</span><span class="p">,</span> <span class="n">max_oct</span><span class="p">,</span> <span class="n">search_radius</span><span class="p">,</span> <span class="n">search_ang</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">discretization</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">krig_type</span><span class="o">=</span><span class="s1">&#39;OK&#39;</span><span class="p">,</span> <span class="n">sk_mean</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=-</span><span class="mf">1.0e21</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">1.0e21</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="s1">&#39;grid&#39;</span><span class="p">,</span> <span class="n">debug_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">debug_file</span><span class="o">=</span><span class="s1">&#39;pyLPM/gslib90/tmp/debug.out&#39;</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;pyLPM/gslib90/tmp/output.out&#39;</span><span class="p">,</span><span class="n">usewine</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Kriging algorithm. This function will show cross validation results if ``option = &#39;cross&#39;or &#39;jackknife&#39;`` or it will return estimated values and variace arrays if ``option = &#39;grid&#39;``. </span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        df (DataFrame): points data DataFrame</span>
<span class="sd">        x (str): x coordinates column name</span>
<span class="sd">        y (str): y coordinates column name</span>
<span class="sd">        z (str): z coordinates column name</span>
<span class="sd">        var (str): variable column name</span>
<span class="sd">        grid (dict): grid definitions dictionary</span>
<span class="sd">        variogram (dict): variogram dictionary</span>
<span class="sd">        min_samples (int): minimum samples</span>
<span class="sd">        max_samples (int): maximum number of samples</span>
<span class="sd">        max_oct (int): maximum number of samples per octant</span>
<span class="sd">        search_radius (list): range1, ramge2, range3 values list</span>
<span class="sd">        search_ang (list, optional): azimuth, dip, rake values list. Defaults to [0,0,0].</span>
<span class="sd">        discretization (list, optional): block discretization. Defaults to [5,5,1].</span>
<span class="sd">        krig_type (str, optional): &#39;SK&#39; or &#39;OK&#39; flag. Defaults to &#39;OK&#39;.</span>
<span class="sd">        sk_mean (float, optional): simple kriging mean. Defaults to 0.</span>
<span class="sd">        tmin (float, optional): minimum trimming limit. Defaults to -1.0e21.</span>
<span class="sd">        tmax (float, optional): maximum trimming limit. Defaults to 1.0e21.</span>
<span class="sd">        option (str, optional): cross validation &#39;cross&#39;, jackknife &#39;jackknife&#39; or estimation &#39;grid&#39; flag . Defaults to &#39;grid&#39;.</span>
<span class="sd">        debug_level (int, optional): debug level. Defaults to 0.</span>
<span class="sd">        debug_file (str, optional): debug file path. Defaults to &#39;pyLPM/gslib90/tmp/debug.out&#39;.</span>
<span class="sd">        output_file (str, optional): output file path. Defaults to &#39;pyLPM/gslib90/tmp/output.out&#39;.</span>
<span class="sd">        usewine (bool, optional): use wine flag. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">write_GeoEAS</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="n">dh</span><span class="o">=</span><span class="n">dh</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span><span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>

    <span class="n">kt3dpar</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">                      Parameters for KT3D</span>
<span class="s1">                  *******************</span>

<span class="s1">START OF PARAMETERS:</span>
<span class="si">{datafile}</span><span class="s1">              -file with data</span>
<span class="si">{dh}</span><span class="s1">  </span><span class="si">{x}</span><span class="s1">  </span><span class="si">{y}</span><span class="s1">  </span><span class="si">{z}</span><span class="s1">  </span><span class="si">{var}</span><span class="s1">  0                 -   columns for DH,X,Y,Z,var,sec var</span>
<span class="si">{tmin}</span><span class="s1">   </span><span class="si">{tmax}</span><span class="s1">                 -   trimming limits</span>
<span class="si">{option}</span><span class="s1">                                -option: 0=grid, 1=cross, 2=jackknife</span>
<span class="si">{datafile}</span><span class="s1">                          -file with jackknife data</span>
<span class="si">{x}</span><span class="s1">   </span><span class="si">{y}</span><span class="s1">   </span><span class="si">{z}</span><span class="s1">    </span><span class="si">{var}</span><span class="s1">    0              -   columns for X,Y,Z,vr and sec var</span>
<span class="si">{debug}</span><span class="s1">                                -debugging level: 0,1,2,3</span>
<span class="si">{debugout}</span><span class="s1">                         -file for debugging output</span>
<span class="si">{kt3dout}</span><span class="s1">                         -file for kriged output</span>
<span class="si">{nx}</span><span class="s1">   </span><span class="si">{ox}</span><span class="s1">    </span><span class="si">{sx}</span><span class="s1">                  -nx,xmn,xsiz</span>
<span class="si">{ny}</span><span class="s1">   </span><span class="si">{oy}</span><span class="s1">    </span><span class="si">{sy}</span><span class="s1">                  -ny,ymn,ysiz</span>
<span class="si">{nz}</span><span class="s1">    </span><span class="si">{oz}</span><span class="s1">    </span><span class="si">{sz}</span><span class="s1">                  -nz,zmn,zsiz</span>
<span class="si">{dx}</span><span class="s1">    </span><span class="si">{dy}</span><span class="s1">      </span><span class="si">{dz}</span><span class="s1">                    -x,y and z block discretization</span>
<span class="si">{min}</span><span class="s1">    </span><span class="si">{max}</span><span class="s1">                           -min, max data for kriging</span>
<span class="si">{max_oct}</span><span class="s1">                                -max per octant (0-&gt; not used)</span>
<span class="si">{r1}</span><span class="s1">  </span><span class="si">{r2}</span><span class="s1">  </span><span class="si">{r3}</span><span class="s1">                 -maximum search radii</span>
<span class="s1"> </span><span class="si">{a1}</span><span class="s1">   </span><span class="si">{a2}</span><span class="s1">   </span><span class="si">{a3}</span><span class="s1">                 -angles for search ellipsoid</span>
<span class="si">{krig_type}</span><span class="s1">     </span><span class="si">{mean}</span><span class="s1">                      -0=SK,1=OK,2=non-st SK,3=exdrift</span>
<span class="s1">0 0 0 0 0 0 0 0 0                -drift: x,y,z,xx,yy,zz,xy,xz,zy</span>
<span class="s1">0                                -0, variable; 1, estimate trend</span>
<span class="s1">extdrift.dat                     -gridded file with drift/mean</span>
<span class="s1">4                                -  column number in gridded file</span>
<span class="si">{varg}</span><span class="s1">&#39;&#39;&#39;</span>

    <span class="n">map_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;datafile&#39;</span><span class="p">:</span><span class="s1">&#39;pyLPM/gslib90/tmp/tmp.dat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;dh&#39;</span><span class="p">:</span> <span class="n">col_number</span><span class="p">(</span><span class="s1">&#39;pyLPM/gslib90/tmp/tmp.dat&#39;</span><span class="p">,</span> <span class="n">dh</span><span class="p">),</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">col_number</span><span class="p">(</span><span class="s1">&#39;pyLPM/gslib90/tmp/tmp.dat&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">col_number</span><span class="p">(</span><span class="s1">&#39;pyLPM/gslib90/tmp/tmp.dat&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
        <span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="n">col_number</span><span class="p">(</span><span class="s1">&#39;pyLPM/gslib90/tmp/tmp.dat&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span>
        <span class="s1">&#39;var&#39;</span><span class="p">:</span><span class="n">col_number</span><span class="p">(</span><span class="s1">&#39;pyLPM/gslib90/tmp/tmp.dat&#39;</span><span class="p">,</span> <span class="n">var</span><span class="p">),</span>
        <span class="s1">&#39;tmin&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="n">tmin</span><span class="p">),</span>
        <span class="s1">&#39;tmax&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="n">tmax</span><span class="p">),</span>
        <span class="s1">&#39;option&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">option</span> <span class="ow">is</span> <span class="s1">&#39;grid&#39;</span> <span class="k">else</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">option</span> <span class="ow">is</span> <span class="s1">&#39;cross&#39;</span> <span class="k">else</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;debug&#39;</span><span class="p">:</span><span class="n">debug_level</span><span class="p">,</span>
        <span class="s1">&#39;debugout&#39;</span><span class="p">:</span><span class="n">debug_file</span><span class="p">,</span>
        <span class="s1">&#39;kt3dout&#39;</span><span class="p">:</span><span class="n">output_file</span><span class="p">,</span>
        <span class="s1">&#39;nx&#39;</span><span class="p">:</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;nx&#39;</span><span class="p">],</span>
        <span class="s1">&#39;ny&#39;</span><span class="p">:</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ny&#39;</span><span class="p">],</span>
        <span class="s1">&#39;nz&#39;</span><span class="p">:</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;nz&#39;</span><span class="p">],</span>
        <span class="s1">&#39;ox&#39;</span><span class="p">:</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ox&#39;</span><span class="p">],</span>
        <span class="s1">&#39;oy&#39;</span><span class="p">:</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;oy&#39;</span><span class="p">],</span>
        <span class="s1">&#39;oz&#39;</span><span class="p">:</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;oz&#39;</span><span class="p">],</span>
        <span class="s1">&#39;sx&#39;</span><span class="p">:</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;sx&#39;</span><span class="p">],</span>
        <span class="s1">&#39;sy&#39;</span><span class="p">:</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;sy&#39;</span><span class="p">],</span>
        <span class="s1">&#39;sz&#39;</span><span class="p">:</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;sz&#39;</span><span class="p">],</span>
        <span class="s1">&#39;dx&#39;</span><span class="p">:</span><span class="n">discretization</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;dy&#39;</span><span class="p">:</span><span class="n">discretization</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="s1">&#39;dz&#39;</span><span class="p">:</span><span class="n">discretization</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">min_samples</span><span class="p">,</span>
        <span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">max_samples</span><span class="p">,</span>
        <span class="s1">&#39;max_oct&#39;</span><span class="p">:</span><span class="n">max_oct</span><span class="p">,</span>
        <span class="s1">&#39;r1&#39;</span><span class="p">:</span><span class="n">search_radius</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;r2&#39;</span><span class="p">:</span><span class="n">search_radius</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="s1">&#39;r3&#39;</span><span class="p">:</span><span class="n">search_radius</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="s1">&#39;a1&#39;</span><span class="p">:</span><span class="n">search_ang</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;a2&#39;</span><span class="p">:</span><span class="n">search_ang</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="s1">&#39;a3&#39;</span><span class="p">:</span><span class="n">search_ang</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="s1">&#39;krig_type&#39;</span><span class="p">:</span><span class="mi">0</span> <span class="k">if</span> <span class="n">krig_type</span> <span class="ow">is</span> <span class="s1">&#39;SK&#39;</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;mean&#39;</span><span class="p">:</span><span class="n">sk_mean</span><span class="p">,</span>
        <span class="s1">&#39;varg&#39;</span><span class="p">:</span><span class="n">write_varg_str</span><span class="p">(</span><span class="n">variogram</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">formatted_str</span> <span class="o">=</span> <span class="n">kt3dpar</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">map_dict</span><span class="p">)</span>
    <span class="n">parfile</span> <span class="o">=</span> <span class="s1">&#39;pyLPM/gslib90/tmp/partmp.par&#39;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">parfile</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">formatted_str</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;pyLPM/gslib90/kt3d.exe&quot;</span>

    <span class="n">call_program</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">parfile</span><span class="p">,</span> <span class="n">usewine</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">option</span> <span class="ow">is</span> <span class="s1">&#39;grid&#39;</span><span class="p">:</span>

        <span class="n">df1</span> <span class="o">=</span> <span class="n">read_GeoEAS</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Estimate&#39;</span><span class="p">],</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;EstimationVariance&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">option</span> <span class="ow">is</span> <span class="s1">&#39;cross&#39;</span> <span class="ow">or</span> <span class="n">option</span> <span class="ow">is</span> <span class="s1">&#39;jackknife&#39;</span><span class="p">:</span>

        <span class="n">df1</span> <span class="o">=</span> <span class="n">read_GeoEAS</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
        <span class="n">real</span><span class="p">,</span> <span class="n">estimate</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">],</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Estimate&#39;</span><span class="p">],</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Error: est-true&#39;</span><span class="p">]</span>
        <span class="n">plots</span><span class="o">.</span><span class="n">xval</span><span class="p">(</span><span class="n">real</span><span class="p">,</span> <span class="n">estimate</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">x_axis</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">,</span> <span class="n">y_axis</span><span class="o">=</span><span class="s1">&#39;False&#39;</span><span class="p">,</span> <span class="n">pointsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mi">900</span><span class="p">))</span></div>


</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, LPM - UFRGS

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'1',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>